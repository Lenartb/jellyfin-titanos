{"{\"assumptions\":{},\"sourceRoot\":\"/mnt/c/Users/lnc/Desktop/jellyfin-titanos/\",\"rootMode\":\"root\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/mnt/c/Users/lnc/Desktop/jellyfin-titanos\",\"filename\":\"/mnt/c/Users/lnc/Desktop/jellyfin-titanos/gulpfile.babel.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/mnt/c/Users/lnc/Desktop/jellyfin-titanos\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-sets-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-class-static-block\",\"visitor\":{\"ClassBody\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-private-property-in-object\",\"visitor\":{\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-numeric-separator\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-logical-assignment-operators\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-nullish-coalescing-operator\",\"visitor\":{\"LogicalExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-json-strings\",\"visitor\":{\"_exploded\":true,\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-catch-binding\",\"visitor\":{\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-generator-functions\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"DoWhileStatement\":{\"exit\":[null]},\"ForInStatement\":{\"exit\":[null]},\"ForStatement\":{\"exit\":[null]},\"WhileStatement\":{\"exit\":[null]},\"ForOfStatement\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null,null]},\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]},\"VoidPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"CallExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.28.4:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.clean = clean;\nexports.copy = copy;\nexports[\"default\"] = void 0;\nexports.modifyIndex = modifyIndex;\nvar _fs = _interopRequireDefault(require(\"fs\"));\nvar _gulp = _interopRequireDefault(require(\"gulp\"));\nvar _del = require(\"del\");\nvar _gulpDom = _interopRequireDefault(require(\"gulp-dom\"));\nvar _path = _interopRequireDefault(require(\"path\"));\nvar _gulpScan = _interopRequireDefault(require(\"gulp-scan\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { \"default\": e }; }\n// Allow overriding of jellyfin-web directory\nvar WEB_DIR = process.env.JELLYFIN_WEB_DIR || 'jellyfin-web/dist';\nWEB_DIR = _path[\"default\"].resolve(WEB_DIR);\nvar titanSdkUrl = 'https://sdk.titanos.tv/sdk/sdk.js';\nconsole.info('Using TitanSdk from', titanSdkUrl);\nconsole.info('Using jellyfin-web from', WEB_DIR);\nvar DISCARD_UNUSED_FONTS = !!process.env.DISCARD_UNUSED_FONTS;\nvar paths = {\n  assets: {\n    src: [WEB_DIR + '/**/*', '!' + WEB_DIR + '/index.html'],\n    dest: 'www/'\n  },\n  index: {\n    src: WEB_DIR + '/index.html',\n    dest: 'www/'\n  }\n};\n\n// Clean the www directory\nfunction clean() {\n  return (0, _del.deleteAsync)(['www']);\n}\n\n// Search for used fonts and add them to assets\nfunction searchFonts() {\n  if (!DISCARD_UNUSED_FONTS) return Promise.resolve('skipped');\n  var assets = paths.assets.src;\n  assets.push('!' + WEB_DIR + '/*.woff2');\n  return _gulp[\"default\"].src(WEB_DIR + '/main*.js').pipe((0, _gulpScan[\"default\"])({\n    term: /[a-z0-9._-]*\\.woff2/gi,\n    fn: function fn(match) {\n      var font = WEB_DIR + '/' + match;\n      if (!assets.includes(font) && _fs[\"default\"].existsSync(font)) {\n        console.debug(\"Found font \".concat(match));\n        assets.push(font);\n      }\n    }\n  }));\n}\n\n// Copy unmodified assets\nfunction copy() {\n  return _gulp[\"default\"].src(paths.assets.src, {\n    encoding: false\n  }).pipe(_gulp[\"default\"].dest(paths.assets.dest));\n}\n\n// Add required tags to index.html\nfunction modifyIndex() {\n  return _gulp[\"default\"].src(paths.index.src).pipe((0, _gulpDom[\"default\"])(function () {\n    // inject CSP meta tag\n    var meta = this.createElement('meta');\n    meta.setAttribute('http-equiv', 'Content-Security-Policy');\n    meta.setAttribute('content', 'default-src * \\'self\\' \\'unsafe-inline\\' \\'unsafe-eval\\' data: gap: file: filesystem: ws: wss:;');\n    this.head.appendChild(meta);\n\n    // Search for injected main.bundle\n    var apploader = this.querySelector('script[src^=main]');\n    if (apploader) {\n      console.debug('Found injected main.bundle');\n      apploader.setAttribute('defer', '');\n    } else {\n      // Search for injected apploader\n      apploader = this.body.querySelector('script[src*=\"apploader\"]');\n      if (apploader) {\n        console.debug('Found injected apploader');\n        apploader.setAttribute('defer', '');\n      } else {\n        console.debug('Inject apploader');\n\n        // inject apploader.js\n        apploader = this.createElement('script');\n        apploader.setAttribute('src', 'scripts/apploader.js');\n        apploader.setAttribute('defer', '');\n        this.body.appendChild(apploader);\n      }\n    }\n    var injectTarget = apploader.parentNode;\n\n    // inject webapis.js\n    var webapis = this.createElement('script');\n    webapis.setAttribute('src', titanSdkUrl);\n    injectTarget.insertBefore(webapis, apploader);\n\n    // inject appMode script\n    var appMode = this.createElement('script');\n    appMode.text = 'window.appMode=\\'cordova\\';';\n    injectTarget.insertBefore(appMode, apploader);\n\n    // inject titanos.js\n    var titanos = this.createElement('script');\n    titanos.setAttribute('src', '../titanos.js');\n    titanos.setAttribute('defer', '');\n    injectTarget.insertBefore(titanos, apploader);\n    return this;\n  })).pipe(_gulp[\"default\"].dest(paths.index.dest));\n}\n\n// Default build task\nvar build = _gulp[\"default\"].series(clean, searchFonts, _gulp[\"default\"].parallel(copy, modifyIndex));\n\n// Export tasks so they can be run individually\n// Export default task\nvar _default = exports[\"default\"] = build;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9ndWxwIiwiX2RlbCIsIl9ndWxwRG9tIiwiX3BhdGgiLCJfZ3VscFNjYW4iLCJlIiwiX19lc01vZHVsZSIsIldFQl9ESVIiLCJwcm9jZXNzIiwiZW52IiwiSkVMTFlGSU5fV0VCX0RJUiIsInBhdGgiLCJyZXNvbHZlIiwidGl0YW5TZGtVcmwiLCJjb25zb2xlIiwiaW5mbyIsIkRJU0NBUkRfVU5VU0VEX0ZPTlRTIiwicGF0aHMiLCJhc3NldHMiLCJzcmMiLCJkZXN0IiwiaW5kZXgiLCJjbGVhbiIsImRlbCIsInNlYXJjaEZvbnRzIiwiUHJvbWlzZSIsInB1c2giLCJndWxwIiwicGlwZSIsInNjYW4iLCJ0ZXJtIiwiZm4iLCJtYXRjaCIsImZvbnQiLCJpbmNsdWRlcyIsImZzIiwiZXhpc3RzU3luYyIsImRlYnVnIiwiY29uY2F0IiwiY29weSIsImVuY29kaW5nIiwibW9kaWZ5SW5kZXgiLCJkb20iLCJtZXRhIiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImhlYWQiLCJhcHBlbmRDaGlsZCIsImFwcGxvYWRlciIsInF1ZXJ5U2VsZWN0b3IiLCJib2R5IiwiaW5qZWN0VGFyZ2V0IiwicGFyZW50Tm9kZSIsIndlYmFwaXMiLCJpbnNlcnRCZWZvcmUiLCJhcHBNb2RlIiwidGV4dCIsInRpdGFub3MiLCJidWlsZCIsInNlcmllcyIsInBhcmFsbGVsIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvbW50L2MvVXNlcnMvbG5jL0Rlc2t0b3AvamVsbHlmaW4tdGl0YW5vcy8iLCJzb3VyY2VzIjpbImd1bHBmaWxlLmJhYmVsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgZ3VscCBmcm9tICdndWxwJztcbmltcG9ydCB7IGRlbGV0ZUFzeW5jIGFzIGRlbCB9IGZyb20gJ2RlbCc7XG5pbXBvcnQgZG9tIGZyb20gJ2d1bHAtZG9tJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHNjYW4gZnJvbSAnZ3VscC1zY2FuJztcblxuLy8gQWxsb3cgb3ZlcnJpZGluZyBvZiBqZWxseWZpbi13ZWIgZGlyZWN0b3J5XG5sZXQgV0VCX0RJUiA9IHByb2Nlc3MuZW52LkpFTExZRklOX1dFQl9ESVIgfHwgJ2plbGx5ZmluLXdlYi9kaXN0JztcbldFQl9ESVIgPSBwYXRoLnJlc29sdmUoV0VCX0RJUik7XG5sZXQgdGl0YW5TZGtVcmwgPSAnaHR0cHM6Ly9zZGsudGl0YW5vcy50di9zZGsvc2RrLmpzJ1xuY29uc29sZS5pbmZvKCdVc2luZyBUaXRhblNkayBmcm9tJywgdGl0YW5TZGtVcmwpO1xuY29uc29sZS5pbmZvKCdVc2luZyBqZWxseWZpbi13ZWIgZnJvbScsIFdFQl9ESVIpO1xuXG5jb25zdCBESVNDQVJEX1VOVVNFRF9GT05UUyA9ICEhcHJvY2Vzcy5lbnYuRElTQ0FSRF9VTlVTRURfRk9OVFM7XG5cbmNvbnN0IHBhdGhzID0ge1xuICAgIGFzc2V0czoge1xuICAgICAgICBzcmM6IFtcbiAgICAgICAgICAgIFdFQl9ESVIgKyAnLyoqLyonLFxuICAgICAgICAgICAgJyEnICsgV0VCX0RJUiArICcvaW5kZXguaHRtbCdcbiAgICAgICAgXSxcbiAgICAgICAgZGVzdDogJ3d3dy8nXG4gICAgfSxcbiAgICBpbmRleDoge1xuICAgICAgICBzcmM6IFdFQl9ESVIgKyAnL2luZGV4Lmh0bWwnLFxuICAgICAgICBkZXN0OiAnd3d3LydcbiAgICB9XG59O1xuXG4vLyBDbGVhbiB0aGUgd3d3IGRpcmVjdG9yeVxuZnVuY3Rpb24gY2xlYW4oKSB7XG4gICAgcmV0dXJuIGRlbChbXG4gICAgICAgICd3d3cnXG4gICAgXSk7XG59XG5cbi8vIFNlYXJjaCBmb3IgdXNlZCBmb250cyBhbmQgYWRkIHRoZW0gdG8gYXNzZXRzXG5mdW5jdGlvbiBzZWFyY2hGb250cygpIHtcbiAgICBpZiAoIURJU0NBUkRfVU5VU0VEX0ZPTlRTKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCdza2lwcGVkJyk7XG5cbiAgICBjb25zdCBhc3NldHMgPSBwYXRocy5hc3NldHMuc3JjO1xuXG4gICAgYXNzZXRzLnB1c2goJyEnICsgV0VCX0RJUiArICcvKi53b2ZmMicpO1xuXG4gICAgcmV0dXJuIGd1bHAuc3JjKFdFQl9ESVIgKyAnL21haW4qLmpzJylcbiAgICAgICAgLnBpcGUoc2Nhbih7XG4gICAgICAgICAgICB0ZXJtOiAvW2EtejAtOS5fLV0qXFwud29mZjIvZ2ksXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZm9udCA9IFdFQl9ESVIgKyAnLycgKyBtYXRjaDtcbiAgICAgICAgICAgICAgICBpZiAoIWFzc2V0cy5pbmNsdWRlcyhmb250KSAmJiBmcy5leGlzdHNTeW5jKGZvbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoYEZvdW5kIGZvbnQgJHttYXRjaH1gKTtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXRzLnB1c2goZm9udCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG59XG5cbi8vIENvcHkgdW5tb2RpZmllZCBhc3NldHNcbmZ1bmN0aW9uIGNvcHkoKSB7XG4gICAgcmV0dXJuIGd1bHAuc3JjKHBhdGhzLmFzc2V0cy5zcmMsIHsgZW5jb2Rpbmc6IGZhbHNlIH0pXG4gICAgICAgIC5waXBlKGd1bHAuZGVzdChwYXRocy5hc3NldHMuZGVzdCkpO1xufVxuXG4vLyBBZGQgcmVxdWlyZWQgdGFncyB0byBpbmRleC5odG1sXG5mdW5jdGlvbiBtb2RpZnlJbmRleCgpIHtcbiAgICByZXR1cm4gZ3VscC5zcmMocGF0aHMuaW5kZXguc3JjKVxuICAgICAgICAucGlwZShkb20oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyBpbmplY3QgQ1NQIG1ldGEgdGFnXG4gICAgICAgICAgICBjb25zdCBtZXRhID0gdGhpcy5jcmVhdGVFbGVtZW50KCdtZXRhJyk7XG4gICAgICAgICAgICBtZXRhLnNldEF0dHJpYnV0ZSgnaHR0cC1lcXVpdicsICdDb250ZW50LVNlY3VyaXR5LVBvbGljeScpO1xuICAgICAgICAgICAgbWV0YS5zZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnLCAnZGVmYXVsdC1zcmMgKiBcXCdzZWxmXFwnIFxcJ3Vuc2FmZS1pbmxpbmVcXCcgXFwndW5zYWZlLWV2YWxcXCcgZGF0YTogZ2FwOiBmaWxlOiBmaWxlc3lzdGVtOiB3czogd3NzOjsnKTtcbiAgICAgICAgICAgIHRoaXMuaGVhZC5hcHBlbmRDaGlsZChtZXRhKTtcblxuICAgICAgICAgICAgLy8gU2VhcmNoIGZvciBpbmplY3RlZCBtYWluLmJ1bmRsZVxuICAgICAgICAgICAgbGV0IGFwcGxvYWRlciA9IHRoaXMucXVlcnlTZWxlY3Rvcignc2NyaXB0W3NyY149bWFpbl0nKTtcblxuICAgICAgICAgICAgaWYgKGFwcGxvYWRlcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ0ZvdW5kIGluamVjdGVkIG1haW4uYnVuZGxlJyk7XG4gICAgICAgICAgICAgICAgYXBwbG9hZGVyLnNldEF0dHJpYnV0ZSgnZGVmZXInLCAnJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFNlYXJjaCBmb3IgaW5qZWN0ZWQgYXBwbG9hZGVyXG4gICAgICAgICAgICAgICAgYXBwbG9hZGVyID0gdGhpcy5ib2R5LnF1ZXJ5U2VsZWN0b3IoJ3NjcmlwdFtzcmMqPVwiYXBwbG9hZGVyXCJdJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoYXBwbG9hZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ0ZvdW5kIGluamVjdGVkIGFwcGxvYWRlcicpO1xuICAgICAgICAgICAgICAgICAgICBhcHBsb2FkZXIuc2V0QXR0cmlidXRlKCdkZWZlcicsICcnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdJbmplY3QgYXBwbG9hZGVyJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaW5qZWN0IGFwcGxvYWRlci5qc1xuICAgICAgICAgICAgICAgICAgICBhcHBsb2FkZXIgPSB0aGlzLmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgICAgICAgICAgICAgICBhcHBsb2FkZXIuc2V0QXR0cmlidXRlKCdzcmMnLCAnc2NyaXB0cy9hcHBsb2FkZXIuanMnKTtcbiAgICAgICAgICAgICAgICAgICAgYXBwbG9hZGVyLnNldEF0dHJpYnV0ZSgnZGVmZXInLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYm9keS5hcHBlbmRDaGlsZChhcHBsb2FkZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgaW5qZWN0VGFyZ2V0ID0gYXBwbG9hZGVyLnBhcmVudE5vZGU7XG5cbiAgICAgICAgICAgIC8vIGluamVjdCB3ZWJhcGlzLmpzXG4gICAgICAgICAgICBjb25zdCB3ZWJhcGlzID0gdGhpcy5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICAgICAgICAgIHdlYmFwaXMuc2V0QXR0cmlidXRlKCdzcmMnLCB0aXRhblNka1VybCk7XG4gICAgICAgICAgICBpbmplY3RUYXJnZXQuaW5zZXJ0QmVmb3JlKHdlYmFwaXMsIGFwcGxvYWRlcik7XG5cbiAgICAgICAgICAgIC8vIGluamVjdCBhcHBNb2RlIHNjcmlwdFxuICAgICAgICAgICAgY29uc3QgYXBwTW9kZSA9IHRoaXMuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgICAgICAgICBhcHBNb2RlLnRleHQgPSAnd2luZG93LmFwcE1vZGU9XFwnY29yZG92YVxcJzsnO1xuICAgICAgICAgICAgaW5qZWN0VGFyZ2V0Lmluc2VydEJlZm9yZShhcHBNb2RlLCBhcHBsb2FkZXIpO1xuXG4gICAgICAgICAgICAvLyBpbmplY3QgdGl0YW5vcy5qc1xuICAgICAgICAgICAgY29uc3QgdGl0YW5vcyA9IHRoaXMuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgICAgICAgICB0aXRhbm9zLnNldEF0dHJpYnV0ZSgnc3JjJywgJy4uL3RpdGFub3MuanMnKTtcbiAgICAgICAgICAgIHRpdGFub3Muc2V0QXR0cmlidXRlKCdkZWZlcicsICcnKTtcbiAgICAgICAgICAgIGluamVjdFRhcmdldC5pbnNlcnRCZWZvcmUodGl0YW5vcywgYXBwbG9hZGVyKTtcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0pKVxuICAgICAgICAucGlwZShndWxwLmRlc3QocGF0aHMuaW5kZXguZGVzdCkpXG59XG5cbi8vIERlZmF1bHQgYnVpbGQgdGFza1xuY29uc3QgYnVpbGQgPSBndWxwLnNlcmllcyhcbiAgICBjbGVhbixcbiAgICBzZWFyY2hGb250cyxcbiAgICBndWxwLnBhcmFsbGVsKGNvcHksIG1vZGlmeUluZGV4KVxuKTtcblxuLy8gRXhwb3J0IHRhc2tzIHNvIHRoZXkgY2FuIGJlIHJ1biBpbmRpdmlkdWFsbHlcbmV4cG9ydCB7XG4gICAgY2xlYW4sXG4gICAgY29weSxcbiAgICBtb2RpZnlJbmRleFxufTtcbi8vIEV4cG9ydCBkZWZhdWx0IHRhc2tcbmV4cG9ydCBkZWZhdWx0IGJ1aWxkO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSxJQUFBQSxHQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxLQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxJQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxRQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxLQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSyxTQUFBLEdBQUFOLHNCQUFBLENBQUFDLE9BQUE7QUFBNkIsU0FBQUQsdUJBQUFPLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxnQkFBQUEsQ0FBQTtBQUU3QjtBQUNBLElBQUlFLE9BQU8sR0FBR0MsT0FBTyxDQUFDQyxHQUFHLENBQUNDLGdCQUFnQixJQUFJLG1CQUFtQjtBQUNqRUgsT0FBTyxHQUFHSSxnQkFBSSxDQUFDQyxPQUFPLENBQUNMLE9BQU8sQ0FBQztBQUMvQixJQUFJTSxXQUFXLEdBQUcsbUNBQW1DO0FBQ3JEQyxPQUFPLENBQUNDLElBQUksQ0FBQyxxQkFBcUIsRUFBRUYsV0FBVyxDQUFDO0FBQ2hEQyxPQUFPLENBQUNDLElBQUksQ0FBQyx5QkFBeUIsRUFBRVIsT0FBTyxDQUFDO0FBRWhELElBQU1TLG9CQUFvQixHQUFHLENBQUMsQ0FBQ1IsT0FBTyxDQUFDQyxHQUFHLENBQUNPLG9CQUFvQjtBQUUvRCxJQUFNQyxLQUFLLEdBQUc7RUFDVkMsTUFBTSxFQUFFO0lBQ0pDLEdBQUcsRUFBRSxDQUNEWixPQUFPLEdBQUcsT0FBTyxFQUNqQixHQUFHLEdBQUdBLE9BQU8sR0FBRyxhQUFhLENBQ2hDO0lBQ0RhLElBQUksRUFBRTtFQUNWLENBQUM7RUFDREMsS0FBSyxFQUFFO0lBQ0hGLEdBQUcsRUFBRVosT0FBTyxHQUFHLGFBQWE7SUFDNUJhLElBQUksRUFBRTtFQUNWO0FBQ0osQ0FBQzs7QUFFRDtBQUNBLFNBQVNFLEtBQUtBLENBQUEsRUFBRztFQUNiLE9BQU8sSUFBQUMsZ0JBQUcsRUFBQyxDQUNQLEtBQUssQ0FDUixDQUFDO0FBQ047O0FBRUE7QUFDQSxTQUFTQyxXQUFXQSxDQUFBLEVBQUc7RUFDbkIsSUFBSSxDQUFDUixvQkFBb0IsRUFBRSxPQUFPUyxPQUFPLENBQUNiLE9BQU8sQ0FBQyxTQUFTLENBQUM7RUFFNUQsSUFBTU0sTUFBTSxHQUFHRCxLQUFLLENBQUNDLE1BQU0sQ0FBQ0MsR0FBRztFQUUvQkQsTUFBTSxDQUFDUSxJQUFJLENBQUMsR0FBRyxHQUFHbkIsT0FBTyxHQUFHLFVBQVUsQ0FBQztFQUV2QyxPQUFPb0IsZ0JBQUksQ0FBQ1IsR0FBRyxDQUFDWixPQUFPLEdBQUcsV0FBVyxDQUFDLENBQ2pDcUIsSUFBSSxDQUFDLElBQUFDLG9CQUFJLEVBQUM7SUFDUEMsSUFBSSxFQUFFLHVCQUF1QjtJQUM3QkMsRUFBRSxFQUFFLFNBQUpBLEVBQUVBLENBQVlDLEtBQUssRUFBRTtNQUNqQixJQUFNQyxJQUFJLEdBQUcxQixPQUFPLEdBQUcsR0FBRyxHQUFHeUIsS0FBSztNQUNsQyxJQUFJLENBQUNkLE1BQU0sQ0FBQ2dCLFFBQVEsQ0FBQ0QsSUFBSSxDQUFDLElBQUlFLGNBQUUsQ0FBQ0MsVUFBVSxDQUFDSCxJQUFJLENBQUMsRUFBRTtRQUMvQ25CLE9BQU8sQ0FBQ3VCLEtBQUssZUFBQUMsTUFBQSxDQUFlTixLQUFLLENBQUUsQ0FBQztRQUNwQ2QsTUFBTSxDQUFDUSxJQUFJLENBQUNPLElBQUksQ0FBQztNQUNyQjtJQUNKO0VBQ0osQ0FBQyxDQUFDLENBQUM7QUFDWDs7QUFFQTtBQUNBLFNBQVNNLElBQUlBLENBQUEsRUFBRztFQUNaLE9BQU9aLGdCQUFJLENBQUNSLEdBQUcsQ0FBQ0YsS0FBSyxDQUFDQyxNQUFNLENBQUNDLEdBQUcsRUFBRTtJQUFFcUIsUUFBUSxFQUFFO0VBQU0sQ0FBQyxDQUFDLENBQ2pEWixJQUFJLENBQUNELGdCQUFJLENBQUNQLElBQUksQ0FBQ0gsS0FBSyxDQUFDQyxNQUFNLENBQUNFLElBQUksQ0FBQyxDQUFDO0FBQzNDOztBQUVBO0FBQ0EsU0FBU3FCLFdBQVdBLENBQUEsRUFBRztFQUNuQixPQUFPZCxnQkFBSSxDQUFDUixHQUFHLENBQUNGLEtBQUssQ0FBQ0ksS0FBSyxDQUFDRixHQUFHLENBQUMsQ0FDM0JTLElBQUksQ0FBQyxJQUFBYyxtQkFBRyxFQUFDLFlBQVc7SUFDakI7SUFDQSxJQUFNQyxJQUFJLEdBQUcsSUFBSSxDQUFDQyxhQUFhLENBQUMsTUFBTSxDQUFDO0lBQ3ZDRCxJQUFJLENBQUNFLFlBQVksQ0FBQyxZQUFZLEVBQUUseUJBQXlCLENBQUM7SUFDMURGLElBQUksQ0FBQ0UsWUFBWSxDQUFDLFNBQVMsRUFBRSxpR0FBaUcsQ0FBQztJQUMvSCxJQUFJLENBQUNDLElBQUksQ0FBQ0MsV0FBVyxDQUFDSixJQUFJLENBQUM7O0lBRTNCO0lBQ0EsSUFBSUssU0FBUyxHQUFHLElBQUksQ0FBQ0MsYUFBYSxDQUFDLG1CQUFtQixDQUFDO0lBRXZELElBQUlELFNBQVMsRUFBRTtNQUNYbEMsT0FBTyxDQUFDdUIsS0FBSyxDQUFDLDRCQUE0QixDQUFDO01BQzNDVyxTQUFTLENBQUNILFlBQVksQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDO0lBQ3ZDLENBQUMsTUFBTTtNQUNIO01BQ0FHLFNBQVMsR0FBRyxJQUFJLENBQUNFLElBQUksQ0FBQ0QsYUFBYSxDQUFDLDBCQUEwQixDQUFDO01BRS9ELElBQUlELFNBQVMsRUFBRTtRQUNYbEMsT0FBTyxDQUFDdUIsS0FBSyxDQUFDLDBCQUEwQixDQUFDO1FBQ3pDVyxTQUFTLENBQUNILFlBQVksQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDO01BQ3ZDLENBQUMsTUFBTTtRQUNIL0IsT0FBTyxDQUFDdUIsS0FBSyxDQUFDLGtCQUFrQixDQUFDOztRQUVqQztRQUNBVyxTQUFTLEdBQUcsSUFBSSxDQUFDSixhQUFhLENBQUMsUUFBUSxDQUFDO1FBQ3hDSSxTQUFTLENBQUNILFlBQVksQ0FBQyxLQUFLLEVBQUUsc0JBQXNCLENBQUM7UUFDckRHLFNBQVMsQ0FBQ0gsWUFBWSxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUM7UUFDbkMsSUFBSSxDQUFDSyxJQUFJLENBQUNILFdBQVcsQ0FBQ0MsU0FBUyxDQUFDO01BQ3BDO0lBQ0o7SUFFQSxJQUFNRyxZQUFZLEdBQUdILFNBQVMsQ0FBQ0ksVUFBVTs7SUFFekM7SUFDQSxJQUFNQyxPQUFPLEdBQUcsSUFBSSxDQUFDVCxhQUFhLENBQUMsUUFBUSxDQUFDO0lBQzVDUyxPQUFPLENBQUNSLFlBQVksQ0FBQyxLQUFLLEVBQUVoQyxXQUFXLENBQUM7SUFDeENzQyxZQUFZLENBQUNHLFlBQVksQ0FBQ0QsT0FBTyxFQUFFTCxTQUFTLENBQUM7O0lBRTdDO0lBQ0EsSUFBTU8sT0FBTyxHQUFHLElBQUksQ0FBQ1gsYUFBYSxDQUFDLFFBQVEsQ0FBQztJQUM1Q1csT0FBTyxDQUFDQyxJQUFJLEdBQUcsNkJBQTZCO0lBQzVDTCxZQUFZLENBQUNHLFlBQVksQ0FBQ0MsT0FBTyxFQUFFUCxTQUFTLENBQUM7O0lBRTdDO0lBQ0EsSUFBTVMsT0FBTyxHQUFHLElBQUksQ0FBQ2IsYUFBYSxDQUFDLFFBQVEsQ0FBQztJQUM1Q2EsT0FBTyxDQUFDWixZQUFZLENBQUMsS0FBSyxFQUFFLGVBQWUsQ0FBQztJQUM1Q1ksT0FBTyxDQUFDWixZQUFZLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQztJQUNqQ00sWUFBWSxDQUFDRyxZQUFZLENBQUNHLE9BQU8sRUFBRVQsU0FBUyxDQUFDO0lBRTdDLE9BQU8sSUFBSTtFQUNmLENBQUMsQ0FBQyxDQUFDLENBQ0ZwQixJQUFJLENBQUNELGdCQUFJLENBQUNQLElBQUksQ0FBQ0gsS0FBSyxDQUFDSSxLQUFLLENBQUNELElBQUksQ0FBQyxDQUFDO0FBQzFDOztBQUVBO0FBQ0EsSUFBTXNDLEtBQUssR0FBRy9CLGdCQUFJLENBQUNnQyxNQUFNLENBQ3JCckMsS0FBSyxFQUNMRSxXQUFXLEVBQ1hHLGdCQUFJLENBQUNpQyxRQUFRLENBQUNyQixJQUFJLEVBQUVFLFdBQVcsQ0FDbkMsQ0FBQzs7QUFFRDtBQU1BO0FBQUEsSUFBQW9CLFFBQUEsR0FBQUMsT0FBQSxjQUNlSixLQUFLIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_fs","_interopRequireDefault","require","_gulp","_del","_gulpDom","_path","_gulpScan","e","__esModule","WEB_DIR","process","env","JELLYFIN_WEB_DIR","path","resolve","titanSdkUrl","console","info","DISCARD_UNUSED_FONTS","paths","assets","src","dest","index","clean","del","searchFonts","Promise","push","gulp","pipe","scan","term","fn","match","font","includes","fs","existsSync","debug","concat","copy","encoding","modifyIndex","dom","meta","createElement","setAttribute","head","appendChild","apploader","querySelector","body","injectTarget","parentNode","webapis","insertBefore","appMode","text","titanos","build","series","parallel","_default","exports"],"sourceRoot":"/mnt/c/Users/lnc/Desktop/jellyfin-titanos/","sources":["gulpfile.babel.js"],"sourcesContent":["import fs from 'fs';\nimport gulp from 'gulp';\nimport { deleteAsync as del } from 'del';\nimport dom from 'gulp-dom';\nimport path from 'path';\nimport scan from 'gulp-scan';\n\n// Allow overriding of jellyfin-web directory\nlet WEB_DIR = process.env.JELLYFIN_WEB_DIR || 'jellyfin-web/dist';\nWEB_DIR = path.resolve(WEB_DIR);\nlet titanSdkUrl = 'https://sdk.titanos.tv/sdk/sdk.js'\nconsole.info('Using TitanSdk from', titanSdkUrl);\nconsole.info('Using jellyfin-web from', WEB_DIR);\n\nconst DISCARD_UNUSED_FONTS = !!process.env.DISCARD_UNUSED_FONTS;\n\nconst paths = {\n    assets: {\n        src: [\n            WEB_DIR + '/**/*',\n            '!' + WEB_DIR + '/index.html'\n        ],\n        dest: 'www/'\n    },\n    index: {\n        src: WEB_DIR + '/index.html',\n        dest: 'www/'\n    }\n};\n\n// Clean the www directory\nfunction clean() {\n    return del([\n        'www'\n    ]);\n}\n\n// Search for used fonts and add them to assets\nfunction searchFonts() {\n    if (!DISCARD_UNUSED_FONTS) return Promise.resolve('skipped');\n\n    const assets = paths.assets.src;\n\n    assets.push('!' + WEB_DIR + '/*.woff2');\n\n    return gulp.src(WEB_DIR + '/main*.js')\n        .pipe(scan({\n            term: /[a-z0-9._-]*\\.woff2/gi,\n            fn: function (match) {\n                const font = WEB_DIR + '/' + match;\n                if (!assets.includes(font) && fs.existsSync(font)) {\n                    console.debug(`Found font ${match}`);\n                    assets.push(font);\n                }\n            }\n        }));\n}\n\n// Copy unmodified assets\nfunction copy() {\n    return gulp.src(paths.assets.src, { encoding: false })\n        .pipe(gulp.dest(paths.assets.dest));\n}\n\n// Add required tags to index.html\nfunction modifyIndex() {\n    return gulp.src(paths.index.src)\n        .pipe(dom(function() {\n            // inject CSP meta tag\n            const meta = this.createElement('meta');\n            meta.setAttribute('http-equiv', 'Content-Security-Policy');\n            meta.setAttribute('content', 'default-src * \\'self\\' \\'unsafe-inline\\' \\'unsafe-eval\\' data: gap: file: filesystem: ws: wss:;');\n            this.head.appendChild(meta);\n\n            // Search for injected main.bundle\n            let apploader = this.querySelector('script[src^=main]');\n\n            if (apploader) {\n                console.debug('Found injected main.bundle');\n                apploader.setAttribute('defer', '');\n            } else {\n                // Search for injected apploader\n                apploader = this.body.querySelector('script[src*=\"apploader\"]');\n\n                if (apploader) {\n                    console.debug('Found injected apploader');\n                    apploader.setAttribute('defer', '');\n                } else {\n                    console.debug('Inject apploader');\n\n                    // inject apploader.js\n                    apploader = this.createElement('script');\n                    apploader.setAttribute('src', 'scripts/apploader.js');\n                    apploader.setAttribute('defer', '');\n                    this.body.appendChild(apploader);\n                }\n            }\n\n            const injectTarget = apploader.parentNode;\n\n            // inject webapis.js\n            const webapis = this.createElement('script');\n            webapis.setAttribute('src', titanSdkUrl);\n            injectTarget.insertBefore(webapis, apploader);\n\n            // inject appMode script\n            const appMode = this.createElement('script');\n            appMode.text = 'window.appMode=\\'cordova\\';';\n            injectTarget.insertBefore(appMode, apploader);\n\n            // inject titanos.js\n            const titanos = this.createElement('script');\n            titanos.setAttribute('src', '../titanos.js');\n            titanos.setAttribute('defer', '');\n            injectTarget.insertBefore(titanos, apploader);\n\n            return this;\n        }))\n        .pipe(gulp.dest(paths.index.dest))\n}\n\n// Default build task\nconst build = gulp.series(\n    clean,\n    searchFonts,\n    gulp.parallel(copy, modifyIndex)\n);\n\n// Export tasks so they can be run individually\nexport {\n    clean,\n    copy,\n    modifyIndex\n};\n// Export default task\nexport default build;\n"],"mappings":"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","ignoreList":[]}},"mtime":1757596560955}}